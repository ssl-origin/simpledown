<!-- INCLUDE overall_header.html -->

<h1>{L_ACP_SIMPLEDOWN_TITLE} - {L_ACP_SIMPLEDOWN_EXISTING_FILES}</h1>

<form id="acp_simpledown" method="post" action="{U_ACTION}" enctype="multipart/form-data">
    {S_FORM_TOKEN}

    <!-- MODO EDIÇÃO DE ARQUIVO -->
    <!-- IF S_EDIT_MODE -->
    <fieldset>
        <legend>{L_ACP_SIMPLEDOWN_EDIT_DESCRIPTION}: <strong>{EDIT_FILE_NAME}</strong></legend>
        <input type="hidden" name="action" value="edit" />
        <input type="hidden" name="id" value="{EDIT_FILE_ID}" />
        <dl>
            <dt><label for="edit_file_name">{L_ACP_SIMPLEDOWN_FILE_NAME}:</label><br />
                <span>{L_ACP_SIMPLEDOWN_FILE_NAME_EXPLAIN}</span>
            </dt>
            <dd><input type="text" id="edit_file_name" name="edit_file_name" value="{EDIT_FILE_NAME}" maxlength="255" size="50" /></dd>
        </dl>
        <dl>
            <dt><label for="edit_file_desc">{L_ACP_SIMPLEDOWN_DESCRIPTION}:</label></dt>
            <dd><textarea id="edit_file_desc" name="edit_file_desc" rows="5" cols="60">{EDIT_FILE_DESC}</textarea></dd>
        </dl>
        <dl>
            <dt><label for="edit_file_version">{L_ACP_SIMPLEDOWN_VERSION}:</label><br />
                <span>{L_ACP_SIMPLEDOWN_VERSION_EXPLAIN}</span>
            </dt>
            <dd><input type="text" id="edit_file_version" name="edit_file_version" value="{EDIT_FILE_VERSION}" maxlength="50" size="20" /></dd>
        </dl>
        <dl>
            <dt><label for="edit_category">{L_ACP_SIMPLEDOWN_CATEGORY}:</label></dt>
            <dd>
                <select id="edit_category" name="edit_category">
                    <option value="0">{L_ACP_SIMPLEDOWN_NO_CATEGORY}</option>
                    <!-- BEGIN categories -->
                    <option value="{categories.ID}" <!-- IF categories.ID == EDIT_FILE_CAT_ID -->selected="selected"<!-- ENDIF -->>{categories.NAME}</option>
                    <!-- END categories -->
                </select>
            </dd>
        </dl>
        <dl>
            <dt><label>{L_ACP_SIMPLEDOWN_REPLACE_FILE}:</label><br />
                <span>{L_ACP_SIMPLEDOWN_REPLACE_FILE_EXPLAIN}</span>
            </dt>
            <dd>
                <input type="checkbox" id="replace_file" name="replace_file" value="1" onchange="document.getElementById('replace_upload_div').style.display = this.checked ? 'block' : 'none';" />
                <div id="replace_upload_div" style="display: none; margin-top: 10px;">
                    <input type="file" name="replace_upload" />
                </div>
            </dd>
        </dl>
        <p class="submit-buttons">
            <input class="button1" type="submit" name="submit_edit" value="{L_ACP_SIMPLEDOWN_SAVE_CHANGES}" />
            <input class="button2" type="button" onclick="window.location.href='{U_ACTION}';" value="{L_ACP_SIMPLEDOWN_CANCEL}" />
        </p>
    </fieldset>
    <!-- ENDIF -->

    <!-- LISTAGEM DE ARQUIVOS -->
    <fieldset>
        <legend>{L_ACP_SIMPLEDOWN_EXISTING_FILES}</legend>

        <!-- Caixa destacada para "Itens por página" -->
        <div style="margin: 20px 0; padding: 10px 16px; background: var(--light-bg); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); display: inline-flex; align-items: center; gap: 12px; flex-wrap: wrap;">
            <label for="perpage_select" style="font-weight: 600; color: var(--text); white-space: nowrap;">{L_ACP_SIMPLEDOWN_ITEMS_PER_PAGE}:</label>
            <form method="get" action="{U_ACTION}" style="margin: 0;">
                <input type="hidden" name="mode" value="files" />
                <select id="perpage_select" name="perpage" onchange="this.form.submit()"
                        style="padding: 8px 12px; font-size: 0.95em; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: all 0.3s ease; min-width: 90px; cursor: pointer;">
                    <option value="10" <!-- IF PERPAGE == 10 -->selected<!-- ENDIF -->>10</option>
                    <option value="20" <!-- IF PERPAGE == 20 -->selected<!-- ENDIF -->>20</option>
                    <option value="50" <!-- IF PERPAGE == 50 -->selected<!-- ENDIF -->>50</option>
                    <option value="100" <!-- IF PERPAGE == 100 -->selected<!-- ENDIF -->>100</option>
                    <option value="0" <!-- IF PERPAGE == 0 -->selected<!-- ENDIF -->>{L_ALL}</option>
                </select>
            </form>
        </div>

        <!-- Campo de busca dinâmica -->
        <div style="margin: 15px 0; display: flex; align-items: center; gap: 10px;">
            <label for="search_input" style="font-weight: 600; color: var(--text);">{L_ACP_SIMPLEDOWN_SEARCH_FILES}:</label>
            <input type="text" id="search_input" placeholder="{L_ACP_SIMPLEDOWN_SEARCH_PLACEHOLDER}"
                   style="padding: 8px 14px; width: 300px; max-width: 100%; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: all 0.3s ease;" />
        </div>

        <!-- Total de arquivos -->
        <div style="margin: 10px 0; font-weight: 600; color: var(--text);">
            {L_ACP_SIMPLEDOWN_TOTAL_FILES}: <strong style="color: var(--primary); font-size: 1.1em;">{TOTAL_FILES}</strong>
        </div>

        <!-- Paginação no topo -->
        <!-- IF ACP_TOTAL_PAGES > 1 -->
        <div class="acp-pagination">
            <span>{L_ACP_SIMPLEDOWN_PAGINATION_INFO}: {ACP_CURRENT_PAGE} / {ACP_TOTAL_PAGES}</span>
            <div class="acp-pagination-buttons">
                <!-- IF ACP_PREV_PAGE -->
                <a href="{ACP_PREV_PAGE}" class="button2">&laquo; {L_PREVIOUS}</a>
                <!-- ENDIF -->
                <!-- IF ACP_NEXT_PAGE -->
                <a href="{ACP_NEXT_PAGE}" class="button2">{L_NEXT} &raquo;</a>
                <!-- ENDIF -->
            </div>
        </div>
        <!-- ENDIF -->

        <!-- IF .files -->
        <table class="table1 compact-table">
            <thead>
                <tr>
                    <th style="width: 35%; text-align: left;">{L_ACP_SIMPLEDOWN_FILE_NAME}</th>
                    <th style="width: 15%; text-align: center;">{L_ACP_SIMPLEDOWN_VERSION}</th>
                    <th style="width: 15%; text-align: center;">{L_ACP_SIMPLEDOWN_CATEGORY_NAME}</th>
                    <th style="width: 15%; text-align: center;">{L_ACP_SIMPLEDOWN_DOWNLOADS} / {L_ACP_SIMPLEDOWN_SIZE}</th>
                    <th style="width: 20%; text-align: center;">{L_ACP_SIMPLEDOWN_ACTIONS}</th>
                </tr>
            </thead>
            <tbody>
                <!-- BEGIN files -->
                <tr>
                    <td style="text-align: left; vertical-align: middle; padding: 12px 18px;">
                        <strong>{files.NAME}</strong><br />
                        <span style="color: #666; font-size: 0.9em;">{files.DESC}</span><br />
                        <small style="color: #999; font-size: 0.85em;">
                            <i class="icon fa-fw {files.FILE_ICON}" aria-hidden="true"></i> {files.REAL_NAME}
                        </small>
                    </td>
                    <td style="text-align: center; vertical-align: middle; padding: 12px 18px;">{files.VERSION}</td>
                    <td style="text-align: center; vertical-align: middle; padding: 12px 18px;">{files.CAT}</td>
                    <td style="text-align: center; vertical-align: middle; padding: 12px 18px;">
                        {files.DOWNLOADS} / {files.SIZE}
                    </td>
                    <td style="text-align: center; vertical-align: middle; padding: 12px 18px;">
                        <a href="{files.U_EDIT}" class="button2" style="padding: 6px 12px; font-size: 0.9em; margin: 0 4px;">{L_ACP_SIMPLEDOWN_EDIT}</a>
                        <a href="{files.U_DELETE}" class="button2" style="padding: 6px 12px; font-size: 0.9em; margin: 0 4px;">{L_ACP_SIMPLEDOWN_DELETE}</a>
                    </td>
                </tr>
                <!-- END files -->
            </tbody>
        </table>
        <!-- ELSE -->
        <p>{L_ACP_SIMPLEDOWN_NO_FILES_YET}</p>
        <!-- ENDIF -->

        <!-- Paginação no rodapé -->
        <!-- IF ACP_TOTAL_PAGES > 1 -->
        <div class="acp-pagination" style="margin-top: 20px;">
            <span>{L_ACP_SIMPLEDOWN_PAGINATION_INFO}: {ACP_CURRENT_PAGE} / {ACP_TOTAL_PAGES}</span>
            <div class="acp-pagination-buttons">
                <!-- IF ACP_PREV_PAGE -->
                <a href="{ACP_PREV_PAGE}" class="button2">&laquo; {L_PREVIOUS}</a>
                <!-- ENDIF -->
                <!-- IF ACP_NEXT_PAGE -->
                <a href="{ACP_NEXT_PAGE}" class="button2">{L_NEXT} &raquo;</a>
                <!-- ENDIF -->
            </div>
        </div>
        <!-- ENDIF -->
    </fieldset>

    {S_FORM_TOKEN}
</form>

<!-- Busca dinâmica (somente pelo nome do arquivo) -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('search_input');
    const rows = document.querySelectorAll('.compact-table tbody tr');
    searchInput.addEventListener('input', function() {
        const filter = searchInput.value.toLowerCase().trim();
        rows.forEach(row => {
            const name = row.querySelector('td:first-child strong')?.textContent.toLowerCase() || '';
            const match = name.includes(filter);
            row.style.display = match ? '' : 'none';
        });
    });
});
</script>

<!-- INCLUDECSS @mundophpbb_simpledown/acp_simpledown.css -->
<!-- INCLUDE overall_footer.html -->
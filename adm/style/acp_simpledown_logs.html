<!-- INCLUDE overall_header.html -->
<!-- INCLUDECSS @mundophpbb_simpledown/acp_simpledown_logs.css -->

<div id="acp_simpledown">
    <h2>{L_ACP_SIMPLEDOWN_LOGS}</h2>
    <p>{L_ACP_SIMPLEDOWN_LOGS_EXPLAIN}</p>

    <div class="stats-box">
        <div class="stat-item">
            <strong>{TOTAL_LOGS}</strong>
            <span>{L_ACP_SIMPLEDOWN_TOTAL_LOGS}</span>
        </div>
        <div class="stat-item">
            <strong>{STATS_TOTAL_DOWNLOADS}</strong>
            <span>{L_ACP_SIMPLEDOWN_STATS_TOTAL_DOWNLOADS}</span>
        </div>
        <!-- ><div class="stat-item">
            <strong>{STATS_TOTAL_VIEWS}</strong>
            <span>{L_ACP_SIMPLEDOWN_STATS_TOTAL_VIEWS}</span>
        </div><! -->
        <div class="stat-item">
            <strong>{STATS_TOTAL_DENIED}</strong>
            <span>{L_ACP_SIMPLEDOWN_STATS_TOTAL_DENIED}</span>
        </div> 
        <div class="stat-item">
            <strong>{STATS_TOP_FILE}</strong><br />
            <span>{L_ACP_SIMPLEDOWN_STATS_TOP_FILE}</span>
        </div>
    </div>

    <!-- IF S_MAX_DISPLAY_WARNING -->
    <div class="errorbox">
        <h3>{L_WARNING}</h3>
        <p>{L_ACP_LOGS_MAX_DISPLAY_WARNING}</p>
    </div>
    <!-- ENDIF -->

    <form id="logs_form" method="post" action="{U_ACTION}">
        {S_FORM_TOKEN}

        <!-- Botões de limpeza (com confirmação JavaScript) -->
        <div style="display: flex; gap: 12px; flex-wrap: wrap; justify-content: flex-end; margin: 20px 0;">
            <button type="submit" class="button2 danger" name="clear_old" value="1" onclick="return confirm('{L_CONFIRM_CLEAR_OLD_LOGS|e('js')}');">
                <i class="fa fa-clock" aria-hidden="true"></i> {L_ACP_LOGS_CLEAR_OLD}
            </button>
            <button type="submit" class="button2 danger" name="clear_all" value="1" onclick="return confirm('{L_CONFIRM_CLEAR_ALL_LOGS|e('js')}');">
                <i class="fa fa-trash" aria-hidden="true"></i> {L_ACP_LOGS_CLEAR_ALL}
            </button>
        </div>

        <div class="table-responsive">
            <table class="table1 zebra-table">
                <thead>
                    <tr>
                        <th style="width: 40px;">
                            <input type="checkbox" name="mark_all" onclick="checkAll(this.form, 'log_id');" title="{L_SELECT_ALL}" />
                        </th>
                        <th>{L_ACP_SIMPLEDOWN_LOG_TIME}</th>
                        <th>{L_ACP_SIMPLEDOWN_LOG_USERNAME}</th>
                        <th>{L_ACP_SIMPLEDOWN_LOG_FILE}</th>
                        <th>{L_ACP_SIMPLEDOWN_LOG_ACTION}</th>
                        <th>{L_IP}</th>
                        <th>{L_ACP_SIMPLEDOWN_LOG_USER_AGENT}</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- IF .logs -->
                    <!-- BEGIN logs -->
                    <tr class="<!-- IF logs.S_ROW_COUNT is even -->bg1<!-- ELSE -->bg2<!-- ENDIF -->">
                        <td style="text-align:center;">
                            <input type="checkbox" name="log_id[]" value="{logs.LOG_ID}" />
                        </td>
                        <td>{logs.LOG_TIME}</td>
                        <td>
                            <!-- IF logs.USER_ID -->
                            <a href="{logs.U_USER_PROFILE}">{logs.USERNAME}</a>
                            <!-- ELSE -->
                            {logs.USERNAME}
                            <!-- ENDIF -->
                        </td>
                        <td>
                            <!-- IF logs.FILE_NAME -->
                            <strong>{logs.FILE_NAME}</strong>
                            <!-- ELSE -->
                            <em>{L_ACP_SIMPLEDOWN_UNKNOWN_FILE}</em>
                            <!-- ENDIF -->
                        </td>
                        <td style="text-align:center;">
                            <!-- IF logs.ACTION == 'download' -->
                            <span class="download-action">{L_ACP_LOGS_ACTION_DOWNLOAD}</span>
                            <!-- ELSEIF logs.ACTION == 'view' -->
                            <span class="view-action">{L_ACP_LOGS_ACTION_PREVIEW}</span>
                            <!-- ELSEIF logs.ACTION == 'denied' -->
                            <span class="denied-action">{L_ACP_SIMPLEDOWN_LOG_ACTION_DENIED}</span>
                            <!-- ELSE -->
                            <span style="padding:4px 10px; border-radius:20px; background:#95a5a6; color:white; font-size:0.8em;">{logs.ACTION}</span>
                            <!-- ENDIF -->
                        </td>
                        <td style="font-family:monospace; font-size:0.9em;">{logs.IP_ADDRESS}</td>
                        <td title="{logs.USER_AGENT_FULL}" style="max-width:200px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">
                            {logs.USER_AGENT}
                        </td>
                    </tr>
                    <!-- END logs -->
                    <!-- ELSE -->
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 80px 20px; color: var(--text-light);">
                            <i class="fa fa-inbox fa-5x" aria-hidden="true" style="opacity:0.3;"></i><br /><br />
                            <strong style="font-size:1.2em;">{L_NO_LOGS_FOUND}</strong>
                        </td>
                    </tr>
                    <!-- ENDIF -->
                </tbody>
            </table>
        </div>

        <!-- IF .logs -->
        <div style="text-align: right; margin-top: 20px;">
            <button type="submit" class="button2 danger" name="delete_selected" value="1"
                    onclick="if (document.querySelectorAll('input[name=\'log_id[]\']:checked').length === 0) { alert('{L_NO_LOGS_SELECTED|e('js')}'); return false; } return confirm('{L_CONFIRM_DELETE_SELECTED_LOGS|e('js')}');">
                <i class="fa fa-trash" aria-hidden="true"></i> {L_DELETE_SELECTED}
            </button>
        </div>
        <!-- ENDIF -->

        <!-- IF .pagination -->
        <div style="margin-top: 20px;">
            {% INCLUDE 'pagination.html' %}
        </div>
        <!-- ENDIF -->
    </form>
</div>

<script>
function checkAll(form, name) {
    for (var i = 0; i < form.elements.length; i++) {
        var e = form.elements[i];
        if (e.name !== 'mark_all' && e.type === 'checkbox' && e.name === name + '[]') {
            e.checked = form.elements['mark_all'].checked;
        }
    }
}
</script>

<!-- INCLUDE overall_footer.html -->
<!-- INCLUDE overall_header.html -->
<h1>{L_ACP_SIMPLEDOWN_TITLE} - {L_ACP_SIMPLEDOWN_SETTINGS}</h1>
<div id="acp_simpledown">
    <!-- CONFIGURAÇÕES GERAIS -->
    <form id="config-form" method="post" action="{U_ACTION}">
        {S_FORM_TOKEN}
        <fieldset>
            <legend>{L_ACP_SIMPLEDOWN_SETTINGS}</legend>
            <dl>
                <dt><label for="max_upload_size">{L_ACP_SIMPLEDOWN_MAX_UPLOAD_SIZE}:</label><br />
                    <span>{L_ACP_SIMPLEDOWN_MAX_UPLOAD_SIZE_EXPLAIN}</span>
                </dt>
                <dd>
                    <input type="number" id="max_upload_size" name="max_upload_size" value="{MAX_UPLOAD_SIZE}" min="1" max="500" step="1" /> MB
                </dd>
            </dl>
            <dl>
                <dt><label for="short_desc_limit">{L_ACP_SIMPLEDOWN_SHORT_DESC_LIMIT}:</label><br />
                    <span>{L_ACP_SIMPLEDOWN_SHORT_DESC_LIMIT_EXPLAIN}</span>
                </dt>
                <dd>
                    <input type="number" id="short_desc_limit" name="short_desc_limit" value="{SHORT_DESC_LIMIT}" min="50" max="500" step="10" /> {L_CHARACTERS}
                </dd>
            </dl>

            <!-- SELETOR DE TEMA PARA O INDEX (PÚBLICO) -->
            <dl>
                <dt><label>{L_ACP_SIMPLEDOWN_SITE_THEME}:</label><br />
                    <span>{L_ACP_SIMPLEDOWN_SITE_THEME_EXPLAIN}</span>
                </dt>
                <dd>
                    <label><input type="radio" name="site_theme" value="light" <!-- IF SITE_THEME == 'light' or not SITE_THEME -->checked="checked"<!-- ENDIF --> /> {L_ACP_SIMPLEDOWN_LIGHT_THEME}</label>&nbsp;&nbsp;&nbsp;&nbsp;
                    <label><input type="radio" name="site_theme" value="dark" <!-- IF SITE_THEME == 'dark' -->checked="checked"<!-- ENDIF --> /> {L_ACP_SIMPLEDOWN_DARK_THEME}</label>
                </dd>
            </dl>

            <!-- Visibilidade padrão para novos arquivos -->
            <dl>
                <dt><label>{L_ACP_SIMPLEDOWN_DEFAULT_VISIBILITY}:</label><br />
                    <span>{L_ACP_SIMPLEDOWN_DEFAULT_VISIBILITY_EXPLAIN}</span>
                </dt>
                <dd>
                    <label><input type="radio" name="default_is_private" value="0" <!-- IF not DEFAULT_IS_PRIVATE -->checked="checked"<!-- ENDIF --> /> {L_ACP_SIMPLEDOWN_PUBLIC}</label>&nbsp;&nbsp;&nbsp;
                    <label><input type="radio" name="default_is_private" value="1" <!-- IF DEFAULT_IS_PRIVATE -->checked="checked"<!-- ENDIF --> /> {L_ACP_SIMPLEDOWN_PRIVATE}</label>
                </dd>
            </dl>

            <!-- Categorias privadas (multiseleção) -->
            <dl>
                <dt><label>{L_ACP_SIMPLEDOWN_PRIVATE_CATEGORIES}:</label><br />
                    <span>{L_ACP_SIMPLEDOWN_PRIVATE_CATEGORIES_EXPLAIN}<br />
                        <em>{L_ACP_SIMPLEDOWN_PRIVATE_CATEGORIES_HOLD_CTRL}</em></span>
                </dt>
                <dd>
                    <select name="private_categories[]" multiple="multiple" size="8">
                        <option value="0" disabled>{L_ACP_SIMPLEDOWN_NO_CATEGORY}</option>
                        <!-- BEGIN categories -->
                        <option value="{categories.ID}" <!-- IF categories.ID in PRIVATE_CATEGORIES -->selected="selected"<!-- ENDIF -->>{categories.NAME}</option>
                        <!-- END categories -->
                    </select>
                </dd>
            </dl>

            <p class="submit-buttons">
                <input class="button1" type="submit" name="config_submit" value="{L_ACP_SIMPLEDOWN_SAVE_CONFIG}" />
            </p>
        </fieldset>
    </form>

    <!-- CATEGORIAS -->
    <form id="category-form" method="post" action="{U_ACTION}">
        {S_FORM_TOKEN}
        <fieldset>
            <legend>{L_ACP_SIMPLEDOWN_ADD_CATEGORY}</legend>
            <dl>
                <dt><label for="cat_name">{L_ACP_SIMPLEDOWN_CATEGORY_NAME}:</label></dt>
                <dd><input type="text" id="cat_name" name="cat_name" maxlength="255" /></dd>
            </dl>
            <p class="submit-buttons">
                <input class="button1" type="submit" name="add_cat" value="{L_ACP_SIMPLEDOWN_ADD_CATEGORY}" />
            </p>
            <dl>
                <dt><label for="delete_category">{L_ACP_SIMPLEDOWN_DELETE_CATEGORY}:</label></dt>
                <dd>
                    <select id="delete_category" name="delete_category">
                        <option value="0">{L_ACP_SIMPLEDOWN_SELECT_CATEGORY_TO_DELETE}</option>
                        <!-- BEGIN delete_categories -->
                        <option value="{delete_categories.ID}">{delete_categories.NAME}</option>
                        <!-- END delete_categories -->
                    </select>
                    <input class="button2 danger" type="submit" name="delete_cat_submit" value="{L_ACP_SIMPLEDOWN_DELETE}" />
                </dd>
            </dl>
            <!-- IF not delete_categories -->
            <p>{L_ACP_SIMPLEDOWN_NO_CATEGORIES_YET}</p>
            <!-- ENDIF -->
        </fieldset>
    </form>

    <!-- ADICIONAR ARQUIVO -->
    <form id="upload-file-form" method="post" action="{U_ACTION}" enctype="multipart/form-data">
        {S_FORM_TOKEN}
        <fieldset>
            <legend>{L_ACP_SIMPLEDOWN_ADD_FILE}</legend>
            <div class="security-notices">
                <div class="warning-box">
                    <strong><i class="fas fa-exclamation-triangle"></i> {L_ACP_SIMPLEDOWN_SECURITY_WARNING_TITLE}</strong><br />
                    {L_ACP_SIMPLEDOWN_SECURITY_WARNING_TEXT_1}<br />
                    {L_ACP_SIMPLEDOWN_SECURITY_WARNING_TEXT_2}
                </div>
                <div class="allowed-box">
                    <strong><i class="fas fa-check-circle"></i> {L_ACP_SIMPLEDOWN_ALLOWED_FILES_TITLE}</strong><br />
                    {L_ACP_SIMPLEDOWN_ALLOWED_FILES_TEXT_1}<br />
                    {L_ACP_SIMPLEDOWN_ALLOWED_FILES_TEXT_2}
                </div>
            </div>
            <dl>
                <dt><label for="file_name">{L_ACP_SIMPLEDOWN_FILE_NAME}:</label></dt>
                <dd><input type="text" id="file_name" name="file_name" maxlength="255" /></dd>
            </dl>
            <dl>
                <dt><label for="file_desc_short">{L_ACP_SIMPLEDOWN_SHORT_DESCRIPTION}:</label><br />
                    <span>{L_ACP_SIMPLEDOWN_SHORT_DESCRIPTION_EXPLAIN}</span>
                </dt>
                <dd><textarea id="file_desc_short" name="file_desc_short" rows="3" cols="60" maxlength="500"></textarea></dd>
            </dl>
            <dl>
                <dt><label for="file_desc">{L_ACP_SIMPLEDOWN_DESCRIPTION}:</label></dt>
                <dd><textarea id="file_desc" name="file_desc" rows="6" cols="60"></textarea></dd>
            </dl>
            <dl>
                <dt><label for="file_version">{L_ACP_SIMPLEDOWN_VERSION}:</label><br />
                    <span>{L_ACP_SIMPLEDOWN_VERSION_EXPLAIN}</span>
                </dt>
                <dd><input type="text" id="file_version" name="file_version" maxlength="50" size="20" /></dd>
            </dl>
            <dl>
                <dt><label for="category">{L_ACP_SIMPLEDOWN_CATEGORY}:</label></dt>
                <dd>
                    <select id="category" name="category">
                        <option value="0">{L_ACP_SIMPLEDOWN_NO_CATEGORY}</option>
                        <!-- BEGIN categories -->
                        <option value="{categories.ID}">{categories.NAME}</option>
                        <!-- END categories -->
                    </select>
                </dd>
            </dl>
            <!-- Visibilidade individual -->
            <dl>
                <dt><label>{L_ACP_SIMPLEDOWN_VISIBILITY}:</label><br />
                    <span>{L_ACP_SIMPLEDOWN_VISIBILITY_EXPLAIN}</span>
                </dt>
                <dd>
                    <label><input type="radio" name="is_private" value="0" <!-- IF not DEFAULT_IS_PRIVATE -->checked="checked"<!-- ENDIF --> /> {L_ACP_SIMPLEDOWN_PUBLIC}</label>&nbsp;&nbsp;
                    <label><input type="radio" name="is_private" value="1" <!-- IF DEFAULT_IS_PRIVATE -->checked="checked"<!-- ENDIF --> /> {L_ACP_SIMPLEDOWN_PRIVATE}</label>
                </dd>
            </dl>
            <!-- Upload do arquivo principal -->
            <dl>
                <dt><label for="file_upload">{L_ACP_SIMPLEDOWN_UPLOAD_FILE}:</label></dt>
                <dd>
                    <div class="custom-file-upload">
                        <input type="file" id="file_upload" name="file_upload" required />
                        <label for="file_upload" class="custom-file-label">
                            <span>{L_ACP_SIMPLEDOWN_CHOOSE_FILE}</span>
                        </label>
                        <span class="file-name-display" id="file-name-display">{L_ACP_SIMPLEDOWN_NO_FILE_SELECTED}</span>
                    </div>
                </dd>
            </dl>
            <!-- Selecionar miniatura existente -->
            <dl>
                <dt><label for="existing_thumb">{L_ACP_SIMPLEDOWN_SELECT_THUMB}:</label></dt>
                <dd>
                    <!-- IF S_THUMBS_EXIST -->
                    <select id="existing_thumb" name="existing_thumb">
                        <option value="">{L_ACP_SIMPLEDOWN_NO_THUMB}</option>
                        <!-- BEGIN thumbs -->
                        <option value="{thumbs.FILENAME}">{thumbs.FILENAME}</option>
                        <!-- END thumbs -->
                    </select>
                    <div id="thumb-preview" style="margin-top: 15px; text-align: center; display: none;">
                        <p><strong>{L_ACP_SIMPLEDOWN_THUMB_PREVIEW}</strong></p>
                        <img id="thumb-preview-img" src="" alt="Pré-visualização" style="max-width: 150px; max-height: 150px; border: 1px solid #ccc; border-radius: 8px;">
                    </div>
                    <!-- ELSE -->
                    <p>{L_ACP_SIMPLEDOWN_NO_THUMBS}</p>
                    <!-- ENDIF -->
                </dd>
            </dl>
            <p class="submit-buttons">
                <input class="button1" type="submit" name="submit" value="{L_ACP_SIMPLEDOWN_UPLOAD_FILE}" />
            </p>
        </fieldset>
    </form>

    <!-- ENVIAR MINIATURA AVULSA -->
    <form id="upload-thumb-form" method="post" action="{U_ACTION}" enctype="multipart/form-data">
        {S_FORM_TOKEN}
        <fieldset>
            <legend>{L_ACP_SIMPLEDOWN_UPLOAD_THUMB}</legend>
            <p>{L_ACP_SIMPLEDOWN_UPLOAD_THUMB_EXPLAIN}</p>
            <dl>
                <dt><label for="thumb_upload">{L_ACP_SIMPLEDOWN_UPLOAD_THUMB}:</label></dt>
                <dd>
                    <div class="custom-file-upload">
                        <input type="file" id="thumb_upload" name="thumb_upload" accept="image/*" />
                        <label for="thumb_upload" class="custom-file-label">
                            <span>{L_ACP_SIMPLEDOWN_CHOOSE_FILE}</span>
                        </label>
                        <span class="file-name-display" id="thumb-name-display">{L_ACP_SIMPLEDOWN_NO_FILE_SELECTED}</span>
                    </div>
                </dd>
            </dl>
            <p class="submit-buttons">
                <input class="button1" type="submit" name="thumb_submit" value="{L_ACP_SIMPLEDOWN_UPLOAD_THUMB}" />
            </p>
        </fieldset>
    </form>
</div> <!-- Fim do #acp_simpledown -->

<!-- MODAL PARA MENSAGENS -->
<div id="message-modal" class="modal">
    <div class="modal-content">
        <span class="close-modal" title="{L_CLOSE}">&times;</span>
        <!-- IF ERROR_MESSAGE -->
        <h3 style="color: #e74c3c;">{L_ACP_SIMPLEDOWN_ERROR}</h3>
        <p id="error-message">{ERROR_MESSAGE}</p>
        <!-- ELSEIF SUCCESS_MESSAGE -->
        <h3 style="color: #27ae60;">{L_ACP_SIMPLEDOWN_SUCCESS}</h3>
        <p id="success-message">{SUCCESS_MESSAGE}</p>
        <!-- ENDIF -->
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // Nome do arquivo principal
    const fileInput = document.getElementById('file_upload');
    const fileNameDisplay = document.getElementById('file-name-display');
    if (fileInput && fileNameDisplay) {
        fileInput.addEventListener('change', e => {
            fileNameDisplay.textContent = e.target.files.length > 0 ? e.target.files[0].name : '{L_ACP_SIMPLEDOWN_NO_FILE_SELECTED}';
        });
    }

    // Nome da miniatura avulsa
    const thumbInput = document.getElementById('thumb_upload');
    const thumbNameDisplay = document.getElementById('thumb-name-display');
    if (thumbInput && thumbNameDisplay) {
        thumbInput.addEventListener('change', e => {
            thumbNameDisplay.textContent = e.target.files.length > 0 ? e.target.files[0].name : '{L_ACP_SIMPLEDOWN_NO_FILE_SELECTED}';
        });
    }

    // Preview de thumbnail existente
    const select = document.getElementById('existing_thumb');
    const previewDiv = document.getElementById('thumb-preview');
    const previewImg = document.getElementById('thumb-preview-img');
    if (select && previewDiv && previewImg) {
        const thumbsDir = '{THUMBS_DIR|escape("js")}';
        const updatePreview = () => {
            const val = select.value.trim();
            if (val) {
                previewImg.src = thumbsDir + encodeURIComponent(val) + '?t=' + new Date().getTime();
                previewDiv.style.display = 'block';
            } else {
                previewDiv.style.display = 'none';
                previewImg.src = '';
            }
        };
        select.addEventListener('change', updatePreview);
        if (select.value) {
            updatePreview();
        }
    }

    // Modal de mensagens
    const modal = document.getElementById('message-modal');
    if (modal) {
        const closeModal = modal.querySelector('.close-modal');
        if (closeModal) {
            closeModal.addEventListener('click', () => modal.style.display = 'none');
        }
        window.addEventListener('click', e => {
            if (e.target === modal) modal.style.display = 'none';
        });
        if ('{ERROR_MESSAGE}' || '{SUCCESS_MESSAGE}') {
            modal.style.display = 'flex';
        }
    }
});
</script>

<!-- INCLUDECSS @mundophpbb_simpledown/acp_simpledown.css -->
<!-- INCLUDE overall_footer.html -->
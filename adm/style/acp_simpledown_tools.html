<!-- INCLUDE overall_header.html -->
<h1>{{ lang('ACP_SIMPLEDOWN_TOOLS') }}</h1>

<div id="acp_simpledown">

    <!-- ======================================== -->
    <!-- SEÇÃO 1: GERENCIAMENTO DE MINIATURAS    -->
    <!-- ======================================== -->
    <!-- Para mudar a ordem: mova todo este bloco de fieldset para cima ou para baixo -->
    <fieldset>
        <legend>{{ lang('ACP_SIMPLEDOWN_THUMBNAILS_MANAGEMENT') }}</legend>
        <p>{{ lang('ACP_SIMPLEDOWN_THUMBNAILS_EXPLAIN_SIMPLE') }}</p>

        <!-- IF S_HAS_THUMBS -->
        <p><strong>{{ lang('ACP_SIMPLEDOWN_TOTAL_THUMBS') }}: {{ TOTAL_THUMBS }}</strong></p>
        <!-- ENDIF -->

        <dl>
            <dt><label for="thumb_select">{{ lang('ACP_SIMPLEDOWN_AVAILABLE_THUMBS') }}:</label></dt>
            <dd>
                <select id="thumb_select" size="1">
                    <option value="">{{ lang('ACP_SIMPLEDOWN_SELECT_ONE_THUMB') }}</option>
                    <!-- BEGIN thumbs -->
                    <option value="{thumbs.U_DELETE}" data-preview="{thumbs.PREVIEW_URL}">
                        {thumbs.FILENAME} ({thumbs.SIZE})
                    </option>
                    <!-- END thumbs -->
                </select>
            </dd>
        </dl>

        <div id="thumb-preview-container" style="display:none; margin-top:25px;">
            <div style="text-align:center; padding:20px; background:var(--light-bg); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow);">
                <p style="margin-bottom:15px; font-weight:600; color:var(--text);">
                    <strong>{{ lang('ACP_SIMPLEDOWN_PREVIEW_TITLE') }}</strong>
                </p>
                <div style="display:inline-block; width:150px; height:150px; background:#fff; border:1px solid var(--border); border-radius:8px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.1);">
                    <img id="preview-img" src="" alt="{{ lang('ACP_SIMPLEDOWN_THUMB_PREVIEW') }}"
                         style="width:100%; height:100%; object-fit:contain; background:#f8f9fa;" />
                </div>
                <div style="margin-top:25px;">
                    <a id="delete-thumb-btn" class="button2 danger" href="javascript:void(0);">
                        <i class="icon fa-trash fa-fw" aria-hidden="true"></i>
                        {{ lang('ACP_SIMPLEDOWN_DELETE_THIS_THUMB') }}
                    </a>
                </div>
            </div>
        </div>

        <!-- IF not S_HAS_THUMBS -->
        <div class="notice" style="margin-top:20px;">
            <p>{{ lang('ACP_SIMPLEDOWN_NO_THUMBS_FOUND') }}</p>
        </div>
        <!-- ENDIF -->
    </fieldset>

    <!-- ======================================== -->
    <!-- SEÇÃO 2: ARQUIVOS ÓRFÃOS NA PASTA /files -->
    <!-- ======================================== -->
    <!-- Para mudar a ordem: mova todo este bloco de fieldset para cima ou para baixo -->
    <fieldset>
        <legend>{{ lang('ACP_SIMPLEDOWN_ORPHAN_FILES_MANAGEMENT') }}</legend>
        <p>{{ lang('ACP_SIMPLEDOWN_ORPHAN_FILES_EXPLAIN') }}</p>

        <!-- IF S_HAS_ORPHAN_FILES -->
        <p><strong>{{ lang('ACP_SIMPLEDOWN_TOTAL_ORPHAN_FILES') }}: {{ TOTAL_ORPHAN_FILES }}</strong></p>
        <!-- ENDIF -->

        <dl>
            <dt><label for="file_select">{{ lang('ACP_SIMPLEDOWN_AVAILABLE_ORPHAN_FILES') }}:</label></dt>
            <dd>
                <select id="file_select" size="1">
                    <option value="">{{ lang('ACP_SIMPLEDOWN_SELECT_ONE_FILE') }}</option>
                    <!-- BEGIN orphan_files -->
                    <option value="{orphan_files.U_DELETE}">
                        {orphan_files.FILENAME} ({orphan_files.SIZE})
                    </option>
                    <!-- END orphan_files -->
                </select>
            </dd>
        </dl>

        <div id="file-delete-container" style="display:none; margin-top:25px; text-align:center;">
            <div style="padding:20px; background:var(--light-bg); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow);">
                <p style="margin-bottom:20px; font-weight:600; color:var(--danger);">
                    <strong>{{ lang('ACP_SIMPLEDOWN_WARNING') }}: {{ lang('ACP_SIMPLEDOWN_CONFIRM_DELETE') }}</strong><br>
                    {{ lang('ACP_SIMPLEDOWN_ORPHAN_DELETE_WARNING') }}
                </p>
                <a id="delete-file-btn" class="button2 danger" href="javascript:void(0);">
                    <i class="icon fa-trash fa-fw" aria-hidden="true"></i>
                    {{ lang('ACP_SIMPLEDOWN_DELETE_THIS_FILE') }}
                </a>
            </div>
        </div>

        <!-- IF not S_HAS_ORPHAN_FILES -->
        <div class="notice" style="margin-top:20px;">
            <p>{{ lang('ACP_SIMPLEDOWN_NO_ORPHAN_FILES_FOUND') }}</p>
        </div>
        <!-- ENDIF -->
    </fieldset>

</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // === Lógica das miniaturas ===
    const thumbSelect = document.getElementById('thumb_select');
    const thumbContainer = document.getElementById('thumb-preview-container');
    const previewImg = document.getElementById('preview-img');
    const deleteThumbBtn = document.getElementById('delete-thumb-btn');

    if (thumbSelect) {
        thumbSelect.addEventListener('change', function () {
            const option = this.options[this.selectedIndex];
            const deleteUrl = this.value || 'javascript:void(0);';
            const preview = option.dataset.preview || '';
            if (deleteUrl !== 'javascript:void(0);' && preview) {
                previewImg.src = preview + '?t=' + Date.now();
                deleteThumbBtn.href = deleteUrl;
                thumbContainer.style.display = 'block';
            } else {
                thumbContainer.style.display = 'none';
                deleteThumbBtn.href = 'javascript:void(0);';
                previewImg.src = '';
            }
        });
        if (thumbSelect.selectedIndex > 0) {
            thumbSelect.dispatchEvent(new Event('change'));
        }
    }

    // === Lógica para arquivos órfãos ===
    const fileSelect = document.getElementById('file_select');
    const fileContainer = document.getElementById('file-delete-container');
    const deleteFileBtn = document.getElementById('delete-file-btn');

    if (fileSelect) {
        fileSelect.addEventListener('change', function () {
            const deleteUrl = this.value || 'javascript:void(0);';
            if (deleteUrl !== 'javascript:void(0);') {
                deleteFileBtn.href = deleteUrl;
                fileContainer.style.display = 'block';
            } else {
                fileContainer.style.display = 'none';
                deleteFileBtn.href = 'javascript:void(0);';
            }
        });
    }
});
</script>

<!-- INCLUDE overall_footer.html -->
<!-- INCLUDECSS @mundophpbb_simpledown/acp_simpledown.css -->